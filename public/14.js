(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{357:function(t,e,a){"use strict";a.r(e);var s=a(2),r=a.n(s);function i(t,e,a,s,r,i,n){try{var o=t[i](n),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(s,r)}var n={data:function(){return{filter:"",listFilter:[],listLogs:[],modalLog:!1,record:{json:""},fullscreenLoading:!1,currentPage1:1,page:0}},filters:{pretty:function(t){return t?JSON.stringify(JSON.parse(t),null,2):""}},mounted:function(){this.getListarLogs()},methods:{handleSizeChange:function(t){console.log("".concat(t," items per page"))},handleCurrentChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.page=t,0==t?t=0:t-=1;var e=10*t,a=e+10;this.listFilter=this.listLogs.slice(e,a)},getListarLogs:function(){var t,e=this;return(t=r.a.mark((function t(){var a,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.fullscreenLoading=!0,t.next=4,e.callGetApi("get","/seguridad/log/index",{filter:e.filter});case 4:a=t.sent,e.listLogs=[],200==a.status?(s=a.data,Object.keys(s).length>0&&s.forEach((function(t){e.listLogs.push({id:t.id,model:t.model,description:t.description,response:t.response,user_id:t.user_id,user_name:t.user?t.user.name:"Generado por migraci칩n",fecha:moment(t.created_at).format("YYYY-MM-DD hh:mm")})})),e.handleCurrentChange()):(401==a.status&&(e.$router.push({name:"login"}),location.reload(),localStorage.clear()),419==a.status&&(e.notification("error","Fue necesario recargar la p치gina",0),location.reload())),e.fullscreenLoading=!1;case 8:case"end":return t.stop()}}),t)})),function(){var e=this,a=arguments;return new Promise((function(s,r){var n=t.apply(e,a);function o(t){i(n,s,r,o,l,"next",t)}function l(t){i(n,s,r,o,l,"throw",t)}o(void 0)}))})()},abrirModalByOption:function(t,e,a){switch(t){case"log":switch(e){case"ver":this.record.json=a.response,this.modalLog=!0}}},abrirModal:function(){this.modalLog=!this.modalLog,this.limpiarModal()},limpiarModal:function(){this.record.json=""}}},o=a(14),l=Object(o.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pcoded-content"},[a("div",{staticClass:"page-header"},[a("div",{staticClass:"page-block"},[a("div",{staticClass:"row align-items-center"},[a("div",{staticClass:"col-md-12"},[t._m(0),t._v(" "),a("ul",{staticClass:"breadcrumb"},[a("li",{staticClass:"breadcrumb-item"},[a("router-link",{attrs:{to:{name:"log.index"}}},[a("i",{staticClass:"feather icon-power"})])],1),t._v(" "),a("li",{staticClass:"breadcrumb-item"},[a("router-link",{attrs:{to:{name:"log.index"}}},[t._v("\n                                Navegar entre Logs\n                            ")])],1)])])])])]),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-header"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-6"},[a("form",{staticClass:"form-inline",on:{submit:function(t){t.preventDefault()}}},[a("div",{staticClass:"form-group mx-sm-3 mb-2 fill"},[a("label",{staticClass:"sr-only"},[t._v("Buscar")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.filter,expression:"filter"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Buscar"},domProps:{value:t.filter},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.getListarLogs(e))},input:function(e){e.target.composing||(t.filter=e.target.value)}}})]),t._v(" "),a("button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"btn btn-primary mb-2",attrs:{type:"button"},on:{"&click":function(e){return t.getListarLogs(e)}}},[t._v("Buscar")])])])])]),t._v(" "),a("div",{staticClass:"card-body table-border-style"},[a("div",{staticClass:"table-responsive"},[t.listFilter.length?[a("table",{staticClass:"table table-hover"},[t._m(1),t._v(" "),a("tbody",t._l(t.listFilter,(function(e,s){return a("tr",{key:s},[a("td",{domProps:{textContent:t._s(e.user_name)}}),t._v(" "),a("td",{domProps:{textContent:t._s(e.description)}}),t._v(" "),a("td",{domProps:{textContent:t._s(e.fecha)}}),t._v(" "),a("td",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Ver Detalle",placement:"top"}},[a("button",{staticClass:"btn  btn-icon btn-outline-primary",on:{click:function(a){return a.preventDefault(),t.abrirModalByOption("log","ver",e)}}},[a("i",{staticClass:"fas fa-eye"})])])],1)])})),0)]),t._v(" "),a("el-pagination",{attrs:{background:"","current-page":t.currentPage1,"page-size":10,layout:"total, prev, pager, next",total:t.listLogs.length},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage1=e},"update:current-page":function(e){t.currentPage1=e}}})]:[a("div",{staticClass:"alert alert-primary",attrs:{role:"alert"}},[t._v("\n                                No se encontraron registros\n                            ")])]],2)])])])]),t._v(" "),a("el-dialog",{attrs:{title:"Detalle de la Acci칩n",visible:t.modalLog,width:"85%","close-on-click-modal":!1},on:{"update:visible":function(e){t.modalLog=e}}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body table-border-style"},[a("pre",[t._v(t._s(t._f("pretty")(t.record.json)))])])])])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.abrirModal}},[t._v("Cerrar")])],1)])],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"page-header-title"},[e("h5",{staticClass:"m-b-10"},[this._v("Gesti칩n de Logs")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Usuario")]),this._v(" "),e("th",[this._v("Proceso")]),this._v(" "),e("th",[this._v("Fecha")]),this._v(" "),e("th",[this._v("Acciones")])])])}],!1,null,null,null);e.default=l.exports}}]);