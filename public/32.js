(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{365:function(r,e,t){"use strict";t.r(e);var a=t(2),s=t.n(a);function o(r,e,t,a,s,o,i){try{var n=r[o](i),l=n.value}catch(r){return void t(r)}n.done?e(l):Promise.resolve(l).then(a,s)}function i(r){return function(){var e=this,t=arguments;return new Promise((function(a,s){var i=r.apply(e,t);function n(r){o(i,a,s,n,l,"next",r)}function l(r){o(i,a,s,n,l,"throw",r)}n(void 0)}))}}var n={data:function(){return{record:{name:"",username:"",email:"",password:"",roles:[],image:"",file_id:""},listRoles:[],form:new FormData,fullscreenLoading:!1,error:0}},mounted:function(){this.getListarRoles()},methods:{usuario_generate:function(){var r=this.record.name.toLocaleLowerCase().trim().split(" "),e="";r.forEach((function(r){e+=r.substr(0,2)})),this.record.username=e,this.record.password=e},limpiarCriterios:function(){this.record.name="",this.record.username="",this.record.email="",this.record.password="",this.record.roles=[]},getListarRoles:function(){var r=this;return i(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.fullscreenLoading=!0,"/seguridad/rol/index",e.next=4,r.callApi("get","/seguridad/rol/index");case 4:200==(t=e.sent).status?r.listRoles=t.data:(401==t.status&&(r.$router.push({name:"login"}),location.reload(),localStorage.clear()),419==t.status&&(r.notification("error","Fue necesario recargar la página",0),location.reload())),r.fullscreenLoading=!1;case 7:case"end":return e.stop()}}),e)})))()},getFile:function(r){this.record.image=r.target.files[0]},setRegistrarUsuario:function(){this.validarRegistrarUsuario()||(this.fullscreenLoading=!0,this.record.image&&null!=this.record.image?this.setRegistrarArchivo():this.setGuardarUsuario())},setRegistrarArchivo:function(){var r=this;return i(s.a.mark((function e(){var t,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.form.append("file",r.record.image),r.form.append("path","user"),t={headers:{"Content-Type":"multipart/form-data"}},"/file/store",e.next=6,r.callApi("post","/file/store",r.form,t);case 6:if(200==(a=e.sent).status)r.record.file_id=a.data,r.setGuardarUsuario();else{if(422==a.status)for(o in a.data.errors)r.notification("error",a.data.errors[o][0]);401==a.status&&(r.$router.push({name:"login"}),location.reload(),localStorage.clear()),419==a.status&&(r.notification("error","Fue necesario recargar la página",0),location.reload())}r.fullscreenLoading=!1;case 9:case"end":return e.stop()}}),e)})))()},setGuardarUsuario:function(){var r=this;return i(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/seguridad/usuario/store",e.next=3,r.callApi("post","/seguridad/usuario/store",r.record);case 3:if(200==(t=e.sent).status)r.notification("success","Registro creado con éxito",0),r.$router.push("/usuario");else{if(422==t.status)for(a in t.data.errors)r.notification("error",t.data.errors[a][0]);401==t.status&&(r.$router.push({name:"login"}),location.reload(),localStorage.clear()),419==t.status&&(r.notification("error","Fue necesario recargar la página",0),location.reload())}r.fullscreenLoading=!1;case 6:case"end":return e.stop()}}),e)})))()},validarRegistrarUsuario:function(){return this.error=0,this.record.name||(this.notification("error","El Nombre es un campo obligatorio",0),this.error=1),this.record.username||(this.notification("error","El Usuario es un campo obligatorio",0),this.error=1),this.record.password||(this.notification("error","La Contraseña es un campo obligatorio",15),this.error=1),this.record.roles&&0!=this.record.roles.length||(this.notification("error","Debe seleccionar al menos un Rol",20),this.error=1),this.error}}},l=t(14),c=Object(l.a)(n,(function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("div",{staticClass:"pcoded-content"},[t("div",{staticClass:"page-header"},[t("div",{staticClass:"page-block"},[t("div",{staticClass:"row align-items-center"},[t("div",{staticClass:"col-md-12"},[r._m(0),r._v(" "),t("ul",{staticClass:"breadcrumb"},[t("li",{staticClass:"breadcrumb-item"},[t("router-link",{attrs:{to:{name:"usuario.index"}}},[t("i",{staticClass:"feather icon-user"})])],1),r._v(" "),t("li",{staticClass:"breadcrumb-item"},[t("router-link",{attrs:{to:{name:"usuario.crear"}}},[r._v("\n                Crear Usuario\n              ")])],1)])])])])]),r._v(" "),t("div",{staticClass:"row"},[t("div",{staticClass:"col-sm-12"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("div",{staticClass:"col-sm-12"},[t("div",{staticClass:"btn-actions"},[t("div",{staticClass:"btn-group card-option"},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Regresar",placement:"top"}},[t("button",{staticClass:"btn btn-icon btn-outline-primary",on:{click:function(e){return e.preventDefault(),r.goBack(e)}}},[t("i",{staticClass:"fas fa-arrow-left"})])])],1)])])]),r._v(" "),t("div",{staticClass:"card-body"},[t("form",{on:{submit:function(r){r.preventDefault()}}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-sm-6"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"Nombre"}},[r._v("Nombre (*)")]),r._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:r.record.name,expression:"record.name"}],staticClass:"form-control",attrs:{type:"text",id:"Nombre",placeholder:"Nombre"},domProps:{value:r.record.name},on:{change:r.usuario_generate,keyup:function(e){return!e.type.indexOf("key")&&r._k(e.keyCode,"enter",13,e.key,"Enter")?null:r.setRegistrarUsuario(e)},input:function(e){e.target.composing||r.$set(r.record,"name",e.target.value)}}})])]),r._v(" "),t("div",{staticClass:"col-sm-6"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"Correo"}},[r._v("Correo Electronico")]),r._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:r.record.email,expression:"record.email"}],staticClass:"form-control",attrs:{type:"email",for:"Correo",placeholder:"Correo Electronico"},domProps:{value:r.record.email},on:{keyup:function(e){return!e.type.indexOf("key")&&r._k(e.keyCode,"enter",13,e.key,"Enter")?null:r.setRegistrarUsuario(e)},input:function(e){e.target.composing||r.$set(r.record,"email",e.target.value)}}})])]),r._v(" "),t("div",{staticClass:"col-sm-6"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"Usuario"}},[r._v("Usuario (*)")]),r._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:r.record.username,expression:"record.username"}],staticClass:"form-control",attrs:{type:"text",id:"Usuario",placeholder:"Usuario"},domProps:{value:r.record.username},on:{keyup:function(e){return!e.type.indexOf("key")&&r._k(e.keyCode,"enter",13,e.key,"Enter")?null:r.setRegistrarUsuario(e)},input:function(e){e.target.composing||r.$set(r.record,"username",e.target.value)}}})])]),r._v(" "),t("div",{staticClass:"col-sm-6"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"Contraseña"}},[r._v("Contraseña (*)")]),r._v(" "),t("el-input",{staticClass:"form-control",attrs:{placeholder:"Contraseña *","show-password":""},on:{keyup:function(e){return!e.type.indexOf("key")&&r._k(e.keyCode,"enter",13,e.key,"Enter")?null:r.setRegistrarUsuario(e)}},model:{value:r.record.password,callback:function(e){r.$set(r.record,"password",e)},expression:"record.password"}})],1)]),r._v(" "),t("div",{staticClass:"col-sm-6"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"Perfil"}},[r._v("Perfil (*)")]),r._v(" "),t("el-select",{attrs:{multiple:"",placeholder:"roles *",filterable:""},model:{value:r.record.roles,callback:function(e){r.$set(r.record,"roles",e)},expression:"record.roles"}},r._l(r.listRoles,(function(r){return t("el-option",{key:r.id,attrs:{label:r.name,value:r.id}})})),1),r._v("Archivo\n                ")],1)]),r._v(" "),t("div",{staticClass:"col-sm-6"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:""}},[r._v("Archivo")]),r._v(" "),t("input",{staticClass:"form-control",class:r.record.image?" image-selected":"",attrs:{type:"file"},on:{change:r.getFile}})])])]),r._v(" "),t("div",{staticClass:"row"},[t("div",{staticClass:"col-sm-12"},[t("button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:r.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"btn btn-outline-primary has-ripple",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),r.setRegistrarUsuario(e)}}},[r._v("\n                  Guardar\n                ")]),r._v(" "),t("button",{staticClass:"btn btn-outline-info has-ripple",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),r.limpiarCriterios(e)}}},[r._v("\n                  Limpiar\n                ")])])])])])])])])])}),[function(){var r=this.$createElement,e=this._self._c||r;return e("div",{staticClass:"page-header-title"},[e("h5",{staticClass:"m-b-10"},[this._v("Gestión Usuarios")])])}],!1,null,"160c8094",null);e.default=c.exports}}]);