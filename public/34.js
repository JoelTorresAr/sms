(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{364:function(t,e,a){"use strict";a.r(e);var s=a(2),r=a.n(s),i=a(12);function o(t,e,a,s,r,i,o){try{var n=t[i](o),l=n.value}catch(t){return void a(t)}n.done?e(l):Promise.resolve(l).then(s,r)}function n(t){return function(){var e=this,a=arguments;return new Promise((function(s,r){var i=t.apply(e,a);function n(t){o(i,s,r,n,l,"next",t)}function l(t){o(i,s,r,n,l,"throw",t)}n(void 0)}))}}function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){u(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function u(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var d={data:function(){return{listUsuarios:[],listFilter:[],filter:"",fullscreenLoading:!1,currentPage1:1,page:0,pageNumber:0,perPage:5,modalUsuario:!1,record:{name:"",username:"",email:"",status:"",status_name:""},listRoles:[],listPermisos:[],listFullPermisos:[]}},mounted:function(){this.loadUser(),this.getListarUsuarios()},methods:c(c({handleSizeChange:function(t){console.log("".concat(t," items per page"))},handleCurrentChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.page=t,0==t?t=0:t-=1;var e=10*t,a=e+10;this.listFilter=this.listUsuarios.slice(e,a)}},Object(i.b)({attempt:"usuario/attempt"})),{},{loadUser:function(){var t=this;this.attempt(localStorage.getItem("token")).then((function(){})).catch((function(e){401==e.response.status&&t.notification("error",e.response.data.error,0)})).finally((function(){t.fullscreenLoading=!1}))},abrirModal:function(){this.modalUsuario=!this.modalUsuario,this.limpiarModal()},limpiarModal:function(){this.record.name="",this.record.email="",this.record.status="",this.record.status_name="",this.listRoles=[],this.listPermisos=[]},getListarUsuarios:function(){var t=this;return n(r.a.mark((function e(){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.fullscreenLoading=!0,"/seguridad/usuario/index",e.next=4,t.callGetApi("get","/seguridad/usuario/index",{filter:t.filter});case 4:200==(a=e.sent).status?(t.listUsuarios=a.data,t.handleCurrentChange()):(401==a.status&&(t.$router.push({name:"login"}),location.reload(),localStorage.clear()),419==a.status&&(t.notification("error","Fue necesario recargar la página",0),location.reload())),t.fullscreenLoading=!1;case 7:case"end":return e.stop()}}),e)})))()},setCambiarEstadoUsuario:function(t,e){var a=this;this.$swal.fire({title:"¿Está seguro de "+(1==t?"desactivar":"activar")+" el usuario?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#2196F3",cancelButtonColor:"#F44336",confirmButtonText:1==t?"Si, desactivar":"Si, activar"}).then((function(s){if(s.value){a.fullscreenLoading=!0;var r="/seguridad/usuario/destroy/"+e;axios.delete(r,{params:{status:1==t?"I":"A"}}).then((function(e){a.notification("success","Se "+(1==t?"desactivo":"activo")+" el usuario",0),a.getListarUsuarios()})).catch((function(t){401==t.response.status&&(a.$router.push({name:"login"}),location.reload(),localStorage.clear(),a.fullscreenLoading=!1),419==t.response.status&&(a.notification("error","Fue necesario recargar la página",0),location.reload())}))}}))},abrirLandingPage:function(t){return n(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.link,"storage/public/image.jpg",window.open("http://landing.ariadna.store/landing_page/web-design/contacts.html?storage/public/image.jpg","__blank");case 3:case"end":return e.stop()}}),e)})))()},getRolById:function(t){var e=this;return n(r.a.mark((function a(){var s,i;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.fullscreenLoading=!0,s="/seguridad/usuario/show/"+t,a.next=4,e.callApi("get",s);case 4:200==(i=a.sent).status?(e.listRoles=i.data.roles,e.listPermisos=i.data.permissions,e.modalUsuario=!0):(401==i.status&&(e.$router.push({name:"login"}),location.reload(),localStorage.clear()),419==i.status&&(e.notification("error","Fue necesario recargar la página",0),location.reload())),e.fullscreenLoading=!1;case 7:case"end":return a.stop()}}),a)})))()},abrirModalByOption:function(t,e,a){switch(t){case"usuario":switch(e){case"ver":this.record.name=a.name,this.record.username=a.username,this.record.email=a.email,this.record.status=a.status,this.record.status_name=a.status_name,this.getRolById(a.id)}}}})},m=a(14),v=Object(m.a)(d,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pcoded-content"},[a("div",{staticClass:"page-header"},[a("div",{staticClass:"page-block"},[a("div",{staticClass:"row align-items-center"},[a("div",{staticClass:"col-md-12"},[t._m(0),t._v(" "),a("ul",{staticClass:"breadcrumb"},[a("li",{staticClass:"breadcrumb-item"},[a("router-link",{attrs:{to:{name:"usuario.index"}}},[a("i",{staticClass:"feather icon-user"})])],1),t._v(" "),a("li",{staticClass:"breadcrumb-item"},[a("router-link",{attrs:{to:{name:"usuario.index"}}},[t._v("\n                                Navegar entre Usuarios\n                            ")])],1)])])])])]),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-header"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-6"},[a("form",{staticClass:"form-inline",on:{submit:function(t){t.preventDefault()}}},[a("div",{staticClass:"form-group mx-sm-3 mb-2 fill"},[a("label",{staticClass:"sr-only"},[t._v("Buscar")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.filter,expression:"filter"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Buscar"},domProps:{value:t.filter},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.getListarUsuarios(e))},input:function(e){e.target.composing||(t.filter=e.target.value)}}})]),t._v(" "),a("button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"btn btn-primary mb-2",attrs:{type:"button"},on:{"&click":function(e){return t.getListarUsuarios(e)}}},[t._v("Buscar")])])]),t._v(" "),a("div",{staticClass:"col-sm-6"},[a("div",{staticClass:"btn-actions"},[t.listPermissions.includes("usuario.crear")?a("div",{staticClass:"btn-group card-option"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Nuevo Usuario",placement:"top"}},[a("router-link",{staticClass:"btn  btn-icon btn-outline-primary",attrs:{to:{name:"usuario.crear"}}},[a("i",{staticClass:"feather icon-plus"})])],1)],1):t._e()])])])]),t._v(" "),a("div",{staticClass:"card-body table-border-style"},[a("div",{staticClass:"table-responsive"},[t.listFilter.length?[a("table",{staticClass:"table table-hover"},[t._m(1),t._v(" "),a("tbody",t._l(t.listFilter,(function(e,s){return a("tr",{key:s},[a("td",{domProps:{textContent:t._s(e.name)}}),t._v(" "),a("td",{domProps:{textContent:t._s(e.email)}}),t._v(" "),a("td",["A"==e.status?a("el-tag",{attrs:{type:"success"},domProps:{textContent:t._s(e.status_name)}}):a("el-tag",{attrs:{type:"danger"},domProps:{textContent:t._s(e.status_name)}})],1),t._v(" "),a("td",["A"==e.status?[t.listPermissions.includes("usuario.ver")?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Ver Usuario",placement:"top"}},[a("button",{staticClass:"btn  btn-icon btn-outline-primary",on:{click:function(a){return a.preventDefault(),t.abrirModalByOption("usuario","ver",e)}}},[a("i",{staticClass:"fas fa-folder"})])]):t._e(),t._v(" "),t.listPermissions.includes("usuario.editar")?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Editar Usuario",placement:"top"}},[a("router-link",{staticClass:"btn  btn-icon btn-outline-info",attrs:{to:{name:"usuario.editar",params:{id:e.id}}}},[a("i",{staticClass:"fas fa-pencil-alt"})])],1):t._e(),t._v(" "),t.listPermissions.includes("usuario.permiso")?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Gestionar Permisos",placement:"top"}},[a("router-link",{staticClass:"btn  btn-icon btn-outline-success",attrs:{to:{name:"usuario.permiso",params:{id:e.id}}}},[a("i",{staticClass:"fas fa-key"})])],1):t._e(),t._v(" "),t.listPermissions.includes("usuario.desactivar")?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Desactivar Usuario",placement:"top"}},[a("button",{staticClass:"btn  btn-icon btn-outline-danger",on:{click:function(a){return a.preventDefault(),t.setCambiarEstadoUsuario(1,e.id)}}},[a("i",{staticClass:"fas fa-eye-slash"})])]):t._e()]:[t.listPermissions.includes("usuario.activar")?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Activar Usuario",placement:"top"}},[a("button",{staticClass:"btn  btn-icon btn-outline-danger",on:{click:function(a){return a.preventDefault(),t.setCambiarEstadoUsuario(2,e.id)}}},[a("i",{staticClass:"fas fa-eye"})])]):t._e()],t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Ver Detalle",placement:"top"}},[a("button",{staticClass:"btn btn-icon btn-outline-primary",on:{click:function(a){return a.preventDefault(),t.abrirLandingPage(e)}}},[a("i",{staticClass:"fas fa-eye"})])])],2)])})),0)]),t._v(" "),a("el-pagination",{attrs:{background:"","current-page":t.currentPage1,"page-size":10,layout:"total, prev, pager, next",total:t.listUsuarios.length},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage1=e},"update:current-page":function(e){t.currentPage1=e}}})]:[a("div",{staticClass:"alert alert-primary",attrs:{role:"alert"}},[t._v("\n                                No se encontraron registros\n                            ")])]],2)])])])]),t._v(" "),a("el-dialog",{attrs:{title:"Detalle Usuario",visible:t.modalUsuario,width:"85%","close-on-click-modal":!1},on:{"update:visible":function(e){t.modalUsuario=e}}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[a("form",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-6"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"Nombre"}},[t._v("Nombre")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.record.name,expression:"record.name"}],staticClass:"form-control",attrs:{type:"text",id:"Nombre",placeholder:"Nombre",readonly:""},domProps:{value:t.record.name},on:{input:function(e){e.target.composing||t.$set(t.record,"name",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"col-sm-6"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"Usuario"}},[t._v("Usuario")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.record.username,expression:"record.username"}],staticClass:"form-control",attrs:{type:"text",id:"Usuario",placeholder:"Usuario",readonly:""},domProps:{value:t.record.username},on:{input:function(e){e.target.composing||t.$set(t.record,"username",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"col-sm-6"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"CorreoElectronico"}},[t._v("Correo Electronico")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.record.email,expression:"record.email"}],staticClass:"form-control",attrs:{type:"text",id:"CorreoElectronico",placeholder:"Correo Electronico",readonly:""},domProps:{value:t.record.email},on:{input:function(e){e.target.composing||t.$set(t.record,"email",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"col-sm-6"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"Estado"}},[t._v("Estado")]),t._v(" "),"A"==t.record.status?a("el-tag",{staticClass:"form-control",attrs:{type:"success"},domProps:{textContent:t._s(t.record.status_name)}}):a("el-tag",{staticClass:"form-control",attrs:{type:"danger"},domProps:{textContent:t._s(t.record.status_name)}})],1)])])])])]),t._v(" "),a("el-divider",[a("strong",[t._v("Roles")])]),t._v(" "),a("div",{staticClass:"card"},[a("div",{staticClass:"card-body table-border-style"},[a("div",{staticClass:"table-responsive"},[t.listRoles.length?[a("table",{staticClass:"table table-hover"},[a("thead",[a("tr",[a("th",[t._v("Descripción")]),t._v(" "),a("th",[t._v("Slug")])])]),t._v(" "),a("tbody",t._l(t.listRoles,(function(e,s){return a("tr",{key:s},[a("td",{domProps:{textContent:t._s(e.name)}}),t._v(" "),a("td",{domProps:{textContent:t._s(e.slug)}})])})),0)])]:[a("div",{staticClass:"alert alert-primary",attrs:{role:"alert"}},[t._v("\n                                    No hay ningún rol asingado al usuario "+t._s(t.record.name)+".\n                                ")])]],2)])]),t._v(" "),a("el-divider",[a("strong",[t._v("Permisos")])]),t._v(" "),a("div",{staticClass:"card"},[a("div",{staticClass:"card-body table-border-style"},[a("div",{staticClass:"table-responsive"},[t.listPermisos.length?[a("table",{staticClass:"table table-hover"},[a("thead",[a("tr",[a("th",[t._v("Descripción")]),t._v(" "),a("th",[t._v("Slug")])])]),t._v(" "),a("tbody",t._l(t.listPermisos,(function(e,s){return a("tr",{key:s},[a("td",{domProps:{textContent:t._s(e.name)}}),t._v(" "),a("td",{domProps:{textContent:t._s(e.slug)}})])})),0)])]:[a("div",{staticClass:"alert alert-primary",attrs:{role:"alert"}},[t._v("\n                                    No hay ningún permiso asingado al usuario "+t._s(t.record.name)+".\n                                ")])]],2)])])],1)]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.abrirModal}},[t._v("Cerrar")])],1)])],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"page-header-title"},[e("h5",{staticClass:"m-b-10"},[this._v("Gestión Usuarios")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Nombre")]),this._v(" "),e("th",[this._v("Correo")]),this._v(" "),e("th",[this._v("Estado")]),this._v(" "),e("th",[this._v("Acciones")])])])}],!1,null,"7b00f056",null);e.default=v.exports}}]);