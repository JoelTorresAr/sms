(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{334:function(n,e,t){var a=t(349);"string"==typeof a&&(a=[[n.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};t(24)(a,r);a.locals&&(n.exports=a.locals)},348:function(n,e,t){"use strict";t(334)},349:function(n,e,t){(n.exports=t(23)(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* .el-radio-group{\n        display: flex;\n        justify-content: flex-start;\n        align-items: center;\n    } */\n",""])},384:function(n,e,t){"use strict";t.r(e);var a=t(2),r=t.n(a);function s(n,e,t,a,r,s,i){try{var o=n[s](i),l=o.value}catch(n){return void t(n)}o.done?e(l):Promise.resolve(l).then(a,r)}function i(n){return function(){var e=this,t=arguments;return new Promise((function(a,r){var i=n.apply(e,t);function o(n){s(i,a,r,o,l,"next",n)}function l(n){s(i,a,r,o,l,"throw",n)}o(void 0)}))}}var o={data:function(){return{filter:"",numMin:0,numMax:100,listFilter:[],listClientes:[],listMensajes:[],multipleSelection:[],record:{body:"",from:"",bodyDefault:""},typeMessage:"MENSAJE LIBRE",listTypes:["MENSAJE LIBRE","MENSAJE PREDETERMINADO"],currentPage1:1,page:0,fullscreenLoading:!1,error:0}},mounted:function(){this.getListarClientes(),this.getListarMensajes(),this.getPhoneNumberById(),this.$route.params.hasOwnProperty("enlace")&&(this.record.body=this.$attrs.enlace)},methods:{limpiarCriterios:function(){this.record.to="",this.record.body="",this.record.bodyDefault="",this.typeMessage="MENSAJE LIBRE",this.$refs.multipleTable.clearSelection()},getListarClientes:function(){var n=this;return i(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.fullscreenLoading=!0,"/operacion/cliente/onlyActive",e.next=4,n.callGetApi("get","/operacion/cliente/onlyActive",{filter:n.filter,numMin:n.numMin,numMax:n.numMax});case 4:200==(t=e.sent).status?n.listClientes=t.data:(401==t.status&&(n.$router.push({name:"login"}),location.reload(),localStorage.clear()),419==t.status&&(n.notification("error","Fue necesario recargar la página",0),location.reload())),n.fullscreenLoading=!1;case 7:case"end":return e.stop()}}),e)})))()},getPhoneNumberById:function(){var n=this;return i(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.fullscreenLoading=!0,"/configuracion/telefono/show",e.next=4,n.callApi("get","/configuracion/telefono/show");case 4:200==(t=e.sent).status?Object.keys(t.data).length>0&&(n.record.from=t.data.phone_number?t.data.phone_number.startsWith("9")?"51"+t.data.phone_number:t.data.phone_number:""):(401==t.status&&(n.$router.push({name:"login"}),location.reload(),localStorage.clear()),419==t.status&&(n.notification("error","Fue necesario recargar la página",0),location.reload())),n.fullscreenLoading=!1;case 7:case"end":return e.stop()}}),e)})))()},getListarMensajes:function(){var n=this;return i(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.fullscreenLoading=!0,"/configuracion/mensaje/index",e.next=4,n.callGetApi("get","/configuracion/mensaje/index",{filter:n.filter});case 4:200==(t=e.sent).status?n.listMensajes=t.data:(401==t.status&&(n.$router.push({name:"login"}),location.reload(),localStorage.clear()),419==t.status&&(n.notification("error","Fue necesario recargar la página",0),location.reload())),n.fullscreenLoading=!1;case 7:case"end":return e.stop()}}),e)})))()},handleSelectionChange:function(n){this.multipleSelection=n},toggleSelection:function(n){n&&this.$refs.multipleTable.toggleRowSelection(n)},changeTypeMessage:function(){this.record.body="",this.record.bodyDefault=""},setGuardarSMS:function(){this.validarRegistrarSMS()||(this.fullscreenLoading=!0,this.preparteData(this.multipleSelection.length>0?this.multipleSelection:this.listClientes))},preparteData:function(n){var e=[];n.forEach((function(n){-1!=n.phone_number.indexOf(",")?n.phone_number.split(",").forEach((function(t){e.push({id:n.id,name:n.name,phone_number:t})})):e.push({id:n.id,name:n.name,phone_number:n.phone_number})})),this.setRegistrarSMS(e)},setRegistrarSMS:function(n){var e=this;return i(r.a.mark((function t(){var a,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/operacion/sms/send",t.next=3,e.callApi("post","/operacion/sms/send",{record:e.record,recipients:n,typeMessage:"MENSAJE LIBRE"==e.typeMessage?1:0});case 3:if(200==(a=t.sent).status)e.notification("success","Registro creado con éxito",0),e.limpiarCriterios();else{if(422==a.status)for(s in a.data.errors)e.notification("error",a.data.errors[s][0]);401==a.status&&(e.$router.push({name:"login"}),location.reload(),localStorage.clear()),419==a.status&&(e.notification("error","Fue necesario recargar la página",0),location.reload())}e.fullscreenLoading=!1;case 6:case"end":return t.stop()}}),t)})))()},validarRegistrarSMS:function(){return this.error=0,this.record.from||(this.notification("error","El Número de Origen es un campo obligatorio",10),this.error=1),"MENSAJE LIBRE"==this.typeMessage?this.record.body||(this.notification("error","El cuerpo es un campo obligatorio",10),this.error=1):this.record.bodyDefault||(this.notification("error","El Mensaje Predeterminado es obligatorio",10),this.error=1),this.error}}},l=(t(348),t(14)),c=Object(l.a)(o,(function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"pcoded-content"},[t("div",{staticClass:"page-header"},[t("div",{staticClass:"page-block"},[t("div",{staticClass:"row align-items-center"},[t("div",{staticClass:"col-md-12"},[n._m(0),n._v(" "),t("ul",{staticClass:"breadcrumb"},[t("li",{staticClass:"breadcrumb-item"},[t("router-link",{attrs:{to:{name:"sms.index"}}},[n._v("\n                Enviar SMS\n              ")])],1)])])])])]),n._v(" "),t("div",{staticClass:"row"},[t("div",{staticClass:"col-sm-6"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-sm-12"},[t("form",{staticClass:"form-inline",on:{submit:function(n){n.preventDefault()}}},[t("div",{staticClass:"form-group mx-sm-3 mb-2 fill"},[t("label",{staticClass:"sr-only"},[n._v("Buscar")]),n._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:n.filter,expression:"filter"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Buscar"},domProps:{value:n.filter},on:{keyup:function(e){return!e.type.indexOf("key")&&n._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),n.getListarClientes(e))},input:function(e){e.target.composing||(n.filter=e.target.value)}}})]),n._v(" "),t("button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:n.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"btn btn-primary mb-2",attrs:{type:"button"},on:{"&click":function(e){return n.getListarClientes(e)}}},[n._v("\n                  Buscar\n                ")])])]),n._v(" "),t("div",{staticClass:"col-sm-12"},[t("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:n.numMin,callback:function(e){n.numMin=e},expression:"numMin"}}),n._v(" "),t("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:n.numMax,callback:function(e){n.numMax=e},expression:"numMax"}})],1)])]),n._v(" "),t("div",{staticClass:"card-body table-border-style"},[t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:n.listClientes,"max-height":"550"},on:{"selection-change":n.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),n._v(" "),t("el-table-column",{attrs:{label:"Nombre",width:"520"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v(n._s(e.row.name))]}}])}),n._v(" "),t("el-table-column",{attrs:{label:"Teléfono",width:"280"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v(n._s(e.row.phone_number))]}}])})],1)],1)])]),n._v(" "),t("div",{staticClass:"col-sm-6"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-body table-border-style"},[n.multipleSelection.length?[t("div",{staticClass:"table-responsive"},[t("table",{staticClass:"table table-hover"},[n._m(1),n._v(" "),t("tbody",n._l(n.multipleSelection,(function(e,a){return t("tr",{key:a},[t("td",[t("el-checkbox",{on:{change:function(t){return n.toggleSelection(e)}}})],1),n._v(" "),t("td",{domProps:{textContent:n._s(e.name)}}),n._v(" "),t("td",{domProps:{textContent:n._s(e.phone_number)}})])})),0)])])]:[t("div",{staticClass:"alert alert-primary",attrs:{role:"alert"}},[n._v("\n              No se encontraron registros\n            ")])]],2)])]),n._v(" "),t("div",{staticClass:"col-sm-12"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-body"},n._l(n.listTypes,(function(e,a){return t("el-radio-group",{key:a,on:{change:n.changeTypeMessage},model:{value:n.typeMessage,callback:function(e){n.typeMessage=e},expression:"typeMessage"}},[t("el-radio",{attrs:{label:e}},[t("el-tag",{attrs:{effect:"plain"}},[n._v(" "+n._s(e)+" ")])],1)],1)})),1)])]),n._v(" "),"MENSAJE PREDETERMINADO"==n.typeMessage?t("div",{staticClass:"col-sm-12"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-body"},n._l(n.listMensajes,(function(e,a){return t("el-radio-group",{key:a,model:{value:n.record.bodyDefault,callback:function(e){n.$set(n.record,"bodyDefault",e)},expression:"record.bodyDefault"}},[t("el-radio",{attrs:{label:e.message}},[t("el-tag",{attrs:{effect:"plain"}},[n._v(" "+n._s(e.message)+" ")])],1)],1)})),1)])]):n._e(),n._v(" "),"MENSAJE LIBRE"==n.typeMessage?t("div",{staticClass:"col-sm-12"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-body"},[t("form",{on:{submit:function(n){n.preventDefault()}}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-sm-12"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"Cuerpo"}},[n._v("Cuerpo (*)")]),n._v(" "),t("el-input",{attrs:{type:"textarea",autosize:{minRows:5,maxRows:14},placeholder:"Ingrese su mensaje de Texto",debounce:1500,maxlength:"1000","show-word-limit":""},model:{value:n.record.body,callback:function(e){n.$set(n.record,"body",e)},expression:"record.body"}})],1)])])])])])]):n._e(),n._v(" "),n.record.body||n.record.bodyDefault?t("div",{staticClass:"col-sm-12"},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-body"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-sm-12"},[t("button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:n.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"btn btn-outline-primary has-ripple",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),n.setGuardarSMS(e)}}},[n._v("\n                Guardar\n              ")]),n._v(" "),t("button",{staticClass:"btn btn-outline-info has-ripple",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),n.limpiarCriterios(e)}}},[n._v("\n                Limpiar\n              ")])])])])])]):n._e()])])}),[function(){var n=this.$createElement,e=this._self._c||n;return e("div",{staticClass:"page-header-title"},[e("h5",{staticClass:"m-b-10"},[this._v("Gestión SMS")])])},function(){var n=this.$createElement,e=this._self._c||n;return e("thead",[e("tr",[e("th",[this._v("Eliminar")]),this._v(" "),e("th",[this._v("Nombre")]),this._v(" "),e("th",[this._v("Teléfono Celular")])])])}],!1,null,"fbd10ea4",null);e.default=c.exports}}]);